# 需求文档 - 用户详情页面归属社区显示修复

## 简介

用户管理页面的用户详情对话框中，"归属社区"字段无法正确显示社区名称。问题原因是前端代码中使用的字段名 `communityName`（驼峰命名）与后端API返回的字段名 `community_name`（下划线命名）不匹配。

## 术语表

- **UserManageView**: 用户管理页面组件
- **getCommunityList**: 获取社区列表的API方法
- **getCommunityName**: 根据社区ID获取社区名称的方法
- **communityList**: 社区列表数据
- **currentUser**: 当前查看详情的用户对象
- **字段映射**: 前端JavaScript对象属性名与后端JSON字段名的对应关系

## 需求

### 需求 1：修复社区名称字段映射

**用户故事**: 作为系统管理员，当我查看用户详情时，我希望能够看到用户归属的社区名称，而不是显示"未知社区"。

#### 验收标准

1. WHEN 用户有归属社区（communityId不为空）THEN 系统应正确显示社区名称
2. WHEN 后端API返回的社区数据使用下划线命名（community_name）THEN 前端应正确映射到驼峰命名（communityName）
3. WHEN 社区列表加载成功后 THEN getCommunityName方法应能根据communityId找到对应的社区
4. WHEN 用户没有归属社区（communityId为空）THEN 应显示"未分配"
5. WHEN 社区ID存在但在社区列表中找不到 THEN 应显示"未知社区"

### 需求 2：统一字段命名规范

**用户故事**: 作为开发者，我需要确保前端代码中所有涉及社区数据的地方都使用统一的字段名称。

#### 验收标准

1. WHEN 处理社区列表数据时 THEN 应将后端的下划线命名转换为前端的驼峰命名
2. WHEN 在模板中引用社区字段时 THEN 应使用驼峰命名（communityName）
3. WHEN 在方法中查找社区时 THEN 应使用正确的字段名进行匹配
4. THE 代码中不应出现字段名不一致导致的undefined或null值

### 需求 3：增强错误处理和数据验证

**用户故事**: 作为开发者，我需要确保即使数据异常也不会导致页面显示错误。

#### 验收标准

1. WHEN 社区列表为空时 THEN getCommunityName方法应返回"未知社区"而不是抛出错误
2. WHEN communityId为null或undefined时 THEN 应正确处理并显示"未分配"
3. WHEN 社区数据结构不完整时 THEN 应有默认值处理
4. THE 控制台不应出现与社区字段相关的错误或警告

### 需求 4：验证其他使用社区数据的地方

**用户故事**: 作为开发者，我需要确保整个用户管理页面中所有使用社区数据的地方都正确工作。

#### 验收标准

1. WHEN 在创建用户对话框中选择社区时 THEN 社区下拉列表应正确显示社区名称
2. WHEN 在编辑用户对话框中选择社区时 THEN 社区下拉列表应正确显示社区名称
3. WHEN 用户列表表格中显示社区信息时 THEN 应正确显示（如果有此字段）
4. THE 所有社区相关的UI组件都应使用统一的字段名
