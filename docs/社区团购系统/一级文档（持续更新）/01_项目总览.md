# 社区团购系统 - 项目总览

**项目名称**: 基于Spring Boot的社区团购系统的设计与实现  
**学生**: 耿康瑞 (20221204229)  
**指导教师**: 於永楠  
**最后更新**: 2025-10-29  
**项目状态**: 🚀 开发中 (70%完成)

---

## 📊 项目概况

### 基本信息
- **开发模式**: T字开发策略（竖向深入 + 横向扩展）
- **架构模式**: 微服务架构（Spring Boot + Spring Cloud）
- **前后端分离**: Vue 3 + Spring Boot 3
- **数据库**: MySQL 8.0（19张表 → 7个微服务数据库，v4.0拆分版）⭐
- **开发进度**: 35% → 55% → 65% → **70%** → 目标100%

### 系统定位
面向社区居民、团长、管理员的一体化团购平台，解决社区团购流程繁琐、团长管理分散、配送效率低下等问题。

---

## 🏗️ 系统架构

### 整体架构
```
┌─────────────────────────────────────────────────────────┐
│                    用户层                                 │
├─────────────────┬─────────────────┬─────────────────────┤
│   用户端(C端)    │   团长端(L端)    │   管理端(A端)        │
│   Vue 3 + EP    │   Vue 3 + EP    │   Vue 3 + EP        │
│   端口: 5173    │   端口: 5175    │   端口: 5174        │
└────────┬────────┴────────┬────────┴──────────┬──────────┘
         │                 │                   │
         └─────────────────┼───────────────────┘
                           │ HTTP/REST
                           ▼
         ┌─────────────────────────────────────┐
         │          API Gateway (可选)          │
         └─────────────────┬───────────────────┘
                           │
         ┌─────────────────┴───────────────────┐
         │          服务发现 (Consul)           │
         └─────────────────┬───────────────────┘
                           │
    ┌──────────────────────┼──────────────────────┐
    │                      │                      │
    ▼                      ▼                      ▼
┌─────────┐          ┌─────────┐          ┌─────────┐
│  User   │          │ Product │          │  Order  │
│ Service │          │ Service │          │ Service │
│  8061   │          │  8062   │          │  8065   │
└────┬────┘          └────┬────┘          └────┬────┘
     │                    │                    │
     │    ┌───────────────┴────────────────┐   │
     │    │        Common 公共模块          │   │
     │    │  (统一响应/异常/日志/工具类)    │   │
     │    └───────────────┬────────────────┘   │
     │                    │                    │
     └────────────────────┼────────────────────┘
                          │
                          ▼
              ┌───────────────────────────────────────┐
              │    MySQL 8.0.36（微服务数据库）      │
              ├─────────────┬─────────────┬─────────┤
              │user_service │product_     │order_   │
              │   _db       │service_db   │service_d│
              │  (5张表)     │  (2张表)    │b(3张表) │
              ├─────────────┼─────────────┼─────────┤
              │groupbuy_    │payment_     │delivery_│
              │service_db   │service_db   │service_d│
              │  (3张表)     │  (1张表)    │b(1张表) │
              ├─────────────┴─────────────┴─────────┤
              │      leader_service_db (4张表)       │
              └──────────────────────────────────────┘
```

### 技术栈
| 层级 | 技术 | 版本 | 说明 |
|------|------|------|------|
| **后端框架** | Spring Boot | 3.2.3 | 核心框架 |
| | Spring Cloud | 2023.0.0 | 微服务框架 |
| | Spring Data JPA | 3.2.3 | ORM框架 |
| **前端框架** | Vue | 3.5.22 | 渐进式框架 |
| | Element Plus | 最新 | UI组件库 |
| | Pinia | 3.0.3 | 状态管理 |
| | Vue Router | 4.5.1 | 路由管理 |
| **数据库** | MySQL | 8.0.36 | 关系数据库 |
| **服务治理** | Consul | - | 服务注册发现 |
| **安全认证** | JWT | 0.11.5 | Token认证 |
| **日志系统** | Logback + AOP | - | 双轨制日志 |
| **工具库** | Hutool | 5.8.25 | Java工具类 |
| **API文档** | SpringDoc | 2.3.0 | Swagger UI |

---

## 🗄️ 数据库设计（v4.0微服务拆分版）⭐

### 微服务数据库架构（7个独立数据库，19张表）

```
user_service_db (用户服务数据库，5张表)
├── sys_user - 用户基础信息（v3.0新增community_id）
├── user_address - 收货地址(含经纬度)
├── user_account - 账户余额
├── user_feedback - 用户反馈
└── sys_operation_log - 操作日志(AOP记录)

product_service_db (商品服务数据库，2张表)
├── product_category - 商品分类
└── product - 商品信息

groupbuy_service_db (拼团服务数据库，3张表)
├── group_buy - 拼团活动模板
├── group_buy_team - 团实例（v3.0新增）
└── group_buy_member - 参团记录（v3.0新增）

order_service_db (订单服务数据库，3张表)
├── shopping_cart - 购物车
├── order_main - 订单主表
└── order_item - 订单明细(快照设计)

payment_service_db (支付服务数据库，1张表)
└── payment_record - 支付记录(AES加密)

delivery_service_db (配送服务数据库，1张表)
└── delivery - 配送单(Dijkstra算法)

leader_service_db (团长服务数据库，4张表)
├── group_leader_store - 团长团点
├── commission_record - 佣金记录
├── community - 社区表（v3.0新增）
└── community_application - 社区申请（v3.0新增）
```

### 微服务拆分特点⭐
- ✅ **数据库隔离**: 每个微服务独立数据库
- ✅ **跨库关联**: 通过应用层校验（Feign调用）
- ✅ **物理外键**: 仅保留单库内外键（10个）
- ✅ **逻辑外键**: 跨库关联通过服务调用（22个）
- ✅ **分布式事务**: Saga模式 + 补偿机制
- ✅ **数据快照**: order_item冗余商品信息
- ✅ **v3.0社区机制**: 支持社区优先推荐

### 数据库设计原则
- ✅ 符合3NF规范
- ✅ 索引优化充分
- ✅ 支持路径规划（经纬度字段）
- ✅ 数据加密设计（密码SHA256、手机号AES、支付数据AES）
- ✅ 微服务架构适配

**详见**: [数据库设计说明文档](../二级文档（参考）/数据库设计说明文档.md)

---

## 📦 已完成模块

### 1. 后端服务（2个/8个）

#### Common模块 ✅ (v1.0.0)
**完成日期**: 2025-10-12  
**代码量**: ~1,500行

**核心功能**:
- 统一响应格式 (Result<T>, PageResult<T>)
- 全局异常处理
- JWT工具类
- 安全工具类 (SHA256, AES)
- 双轨制日志系统 (Logback + AOP)
  - 技术日志 → 文件系统
  - 业务日志 → MySQL数据库
  - @OperationLog注解无侵入记录

**亮点**:
- 🌟 AOP操作日志自动记录
- 🌟 异步线程池优化性能
- 🌟 敏感信息自动脱敏

#### UserService ✅ (v4.0 微服务拆分版)⭐
**完成日期**: 2025-10-12（初版）→ 2025-10-29（微服务升级）  
**代码量**: ~4,200行  
**接口数**: 41个RESTful API（31个用户端 + 10个Feign内部接口）⭐  
**数据库**: user_service_db（独立数据库，5张表）⭐

**功能模块**:
- 用户管理 (10个API): 注册/登录(JWT)/信息管理/角色管理
- 地址管理 (7个API): CRUD/默认地址设置
- 账户管理 (5个API): 余额查询/充值/扣款/冻结
- 反馈管理 (8个API): 提交/查询/管理员回复
- **社区关联 (4个API)**: 关联社区/查询社区用户⭐v3.0新增
- **Feign接口 (10个API)**: 供其他微服务调用⭐v4.0新增

**技术亮点**:
- 🌟 JWT认证机制(7天有效期)
- 🌟 密码SHA256加密
- 🌟 手机号AES加密
- 🌟 自动创建用户账户
- ⭐ **微服务数据库隔离**（v4.0）
- ⭐ **Feign服务间调用**（v4.0）
- ⭐ **Saga分布式事务支持**（v4.0）
- ⭐ **v3.0社区机制**（community_id字段）

**Swagger**: http://localhost:8061/swagger-ui.html

### 2. 前端应用（2个/3个）

#### 管理后台 ✅ (v1.0)
**完成日期**: 2025-10-14  
**代码量**: ~2,500行  
**端口**: 5174

**已实现页面**:
- ✅ 用户管理 (列表/创建/编辑/删除/详情)
- ✅ 反馈管理 (列表/回复/删除)
- ✅ 日志管理 (查询/筛选/导出Excel)

**技术特点**:
- Element Plus完整集成
- Pinia状态管理
- Axios请求拦截
- 实时数据刷新

#### 用户端前端 ✅ (v0.85)
**完成日期**: 2025-10-21  
**代码量**: ~4,000行  
**端口**: 5173  
**完成度**: 85%

**已实现页面** (13个):

完整实现 (9个):
- ✅ 首页 (轮播图/分类/搜索/热门推荐)
- ✅ 商品列表 (筛选/排序/分页)
- ✅ 商品详情 (加购物车/拼团)
- ✅ 购物车 (数量调整/结算)
- ✅ 个人中心 (功能菜单)
- ✅ 个人信息 (对接UserService)
- ✅ 收货地址 (对接UserService)
- ✅ 我的余额 (对接UserService)
- ✅ 意见反馈 (对接UserService)

占位页面待完善 (3个):
- ⏳ 拼团活动详情
- ⏳ 订单确认
- ⏳ 订单列表

**技术亮点**:
- 🌟 Mock数据完整支持
- 🌟 LocalStorage购物车
- 🌟 响应式设计
- 🌟 统一导航栏

---

## 🚧 待开发模块

### 后端服务（6个待开发）
| 服务 | 端口 | 功能 | 优先级 | 预计时间 |
|------|------|------|--------|---------|
| ProductService | 8062 | 商品管理、分类、库存 | 🔴 高 | 2-3天 |
| GroupBuyService | 8063 | 拼团活动、成团逻辑 | 🔴 高 | 2-3天 |
| OrderService | 8065 | 订单管理、状态流转 | 🔴 高 | 3-4天 |
| PaymentService | 8066 | 支付、充值、退款 | 🔴 高 | 3-4天 |
| DeliveryService | 8067 | Dijkstra路径规划 | 🟡 中 | 2-3天 |
| LeaderService | 8068 | 团长管理、佣金计算 | 🟡 中 | 2-3天 |

### 前端应用（1个待开发）
| 应用 | 端口 | 页面数 | 优先级 | 预计时间 |
|------|------|--------|--------|---------|
| 团长端 | 5175 | 5个 | 🟡 中 | 2-3天 |

### 前端页面完善
| 页面 | 说明 | 优先级 | 预计时间 |
|------|------|--------|---------|
| 拼团活动详情 | 从占位到完整实现 | 🔴 高 | 0.5天 |
| 订单确认 | 从占位到完整实现 | 🔴 高 | 0.5天 |
| 订单列表 | 从占位到完整实现 | 🔴 高 | 0.5天 |
| 管理端商品管理 | 新页面 | 🔴 高 | 1天 |
| 管理端拼团管理 | 新页面 | 🟡 中 | 0.5天 |
| 管理端团长审核 | 新页面 | 🟡 中 | 0.5天 |
| 管理端数据统计 | 新页面 | 🟢 低 | 0.5天 |

---

## 🎯 T字开发策略

### 竖向深入（已完成35%）
```
✅ 数据库设计 (17张表)
✅ Common模块 (公共组件)
✅ 日志系统 (双轨制)
✅ UserService (31个API)
✅ 管理后台 (用户+反馈+日志)
```

### 横向扩展（当前阶段，已完成20%）
```
✅ 用户端界面原型 (13个页面，85%完成)
   - 完整实现9个页面
   - 占位页面3个

⏳ 用户端页面完善 (3个占位页面)
⏳ 团长端界面原型 (5个页面)
⏳ 管理端界面扩展 (4个页面)
```

### 后续深入（第二轮竖向）
```
⏳ ProductService开发
⏳ GroupBuyService开发
⏳ OrderService开发
⏳ PaymentService开发
⏳ 前后端对接
⏳ 集成测试
```

**战略价值**:
- ✨ 竖向验证技术栈可行性
- ✨ 横向建立完整用户体验
- ✨ 降低风险、快速反馈
- ✨ 便于演示和评审

---

## 💡 核心功能亮点

### 1. 双轨制日志系统 ⭐⭐⭐⭐⭐
```
技术日志 (Logback)          业务日志 (AOP)
├── 控制台彩色输出           ├── @OperationLog注解
├── 文件持久化               ├── 异步保存数据库
├── 按日期+大小滚动          ├── 自动获取用户信息
└── 保留30天                 └── 敏感信息脱敏

用途：开发调试              用途：业务审计
```

### 2. JWT认证机制 ⭐⭐⭐⭐
- Token有效期7天
- 无状态设计，支持分布式
- 白名单机制
- 自动刷新（待实现）

### 3. 数据加密方案 ⭐⭐⭐⭐
- 密码: SHA256 + 盐值（不可逆）
- 手机号: AES加密（可解密）
- 支付数据: AES加密 + SHA256签名

### 4. Mock数据支持 ⭐⭐⭐
- 商品数据: 12个商品、3个分类
- 拼团数据: 3个拼团活动
- 订单数据: 完整订单结构
- 购物车: LocalStorage持久化

### 5. 数据库快照设计 ⭐⭐⭐
- order_item表保存下单时的商品快照
- 避免商品变更影响历史订单
- 符合电商系统最佳实践

---

## 📈 开发进度

### 整体进度
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
已完成: ████████████████████████░░░░░░  70%
目标:   █████████████████████████████░  100%
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 模块完成情况
| 模块分类 | 计划 | 已完成 | 进行中 | 待开发 | 完成率 |
|---------|------|--------|--------|--------|--------|
| 后端服务 | 8个 | 2个 | 0个 | 6个 | 25% |
| 微服务数据库 | 7个 | 7个 | - | 0个 | 100% ⭐ |
| 前端应用 | 3个 | 2个 | 0个 | 1个 | 67% |
| 数据库表 | 19张 | 19张 | - | 0张 | 100% |
| API接口 | ~120个 | 41个 | 0个 | ~79个 | 34% ⭐ |
| 前端页面 | ~30个 | 16个 | 0个 | ~14个 | 53% |

### 代码量统计
- 后端代码: ~5,700行（+700行微服务升级）⭐
- 前端代码: ~6,500行
- 文档: ~60,000字（+10,000字）⭐
- SQL脚本: 7个微服务数据库脚本⭐
- 总计: ~12,200行代码

---

## 🏆 项目优势

### 技术优势
✅ **现代化技术栈** - Spring Boot 3 + Vue 3最新版本  
✅ **微服务架构** - 模块化设计，易于扩展  
✅ **安全性强** - JWT + 多重数据加密  
✅ **日志完善** - 双轨制日志系统  
✅ **文档齐全** - 20+技术文档，5万字

### 开发优势
✅ **T字开发策略** - 竖向验证+横向扩展  
✅ **代码规范** - 统一规范、注释完整  
✅ **可演示性** - Mock数据支持独立演示  
✅ **快速迭代** - 敏捷开发、持续交付

### 业务优势
✅ **完整的业务流程** - 覆盖用户、团长、管理员三端  
✅ **真实的业务场景** - 基于实际团购需求设计  
✅ **创新的路径规划** - Dijkstra算法优化配送  
✅ **精细化权限管理** - 三种角色精确控制

---

## 🚀 下一步计划

### 短期目标（1-2周）
1. ✅ 完善用户端3个占位页面
2. 🔴 开发ProductService（商品管理服务）
3. 🔴 开发GroupBuyService（拼团服务）

### 中期目标（3-4周）
4. 🔴 开发OrderService（订单服务）
5. 🔴 开发PaymentService（支付服务）
6. 🟡 前后端API对接
7. 🟡 集成测试

### 长期目标（5-8周）
8. 🟡 开发团长端界面
9. 🟡 管理端界面扩展
10. 🟢 性能优化
11. 🟢 文档完善
12. 🟢 答辩准备

**详见**: [03_开发规划](./03_开发规划.md)

---

## ⚠️ 风险控制

### 技术风险
- 微信支付集成复杂 → 提前学习官方文档
- Dijkstra算法性能 → 限制配送点数量
- 微服务通信 → 配置重试机制

### 进度风险
- 微服务拆分过细 → 合并部分服务
- 前端工作量大 → 使用UI组件库
- 测试时间不足 → 边开发边测试

---

## 📞 项目信息

**开发者**: 耿康瑞  
**学号**: 20221204229  
**院校**: 北京城市学院  
**指导教师**: 於永楠  
**项目路径**: E:\E\BYSJ

**在线访问**:
- Swagger文档: http://localhost:8061/swagger-ui.html
- Consul控制台: http://localhost:8500
- 用户端前端: http://localhost:5173
- 管理端前端: http://localhost:5174

**文档路径**: E:\E\BYSJ\docs\社区团购系统\

---

## 📚 相关文档

- [00_文档导航](./00_文档导航.md) - 文档导航中心
- [02_开发进度追踪](./02_开发进度追踪.md) - 实时进度管理
- [03_开发规划](./03_开发规划.md) - 详细开发计划
- [数据库设计说明文档](./数据库设计说明文档.md) - 数据库完整设计
- [API_UserService](./API_UserService.md) - 用户服务接口文档

---

**创建日期**: 2025-10-27  
**文档版本**: v1.0  
**状态**: ✅ 项目总览文档创建完成

