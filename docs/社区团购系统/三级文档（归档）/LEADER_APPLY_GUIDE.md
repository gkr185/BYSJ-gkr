# 团长申请功能使用指南

## 📋 功能概述

团长申请功能已完整实现，用户可以通过此功能申请成为社区团长，获得发起拼团和赚取佣金的权限。

## ✨ 功能特点

### 1. 完整的申请流程
- ✅ 团长基本信息填写（姓名、电话）
- ✅ 团点信息填写（名称、地址、简介）
- ✅ 社区选择（支持多种方式）
- ✅ 申请状态查看
- ✅ 重新申请功能

### 2. 智能社区选择
- 🗺️ **根据当前定位自动匹配最近社区**（Haversine算法）
- 📍 **根据默认收货地址匹配社区**
- 📝 **手动选择社区**（下拉列表，支持搜索）
- ➕ **申请新社区支持**（如果现有社区不满足需求）

### 3. 人性化的用户体验
- 📊 实时显示申请状态（审核中、已通过、未通过）
- 💡 清晰的申请须知说明
- 🎨 美观的渐变色设计
- 📱 完全响应式布局（PC端和移动端）
- ⚡ 表单实时验证
- 🔒 防止重复提交

### 4. 多入口访问
- 个人中心直接访问（仅非团长用户可见，带"HOT"标签）
- 直接路由访问：`/leader/apply`

## 🎯 使用流程

### 普通用户申请成为团长

1. **进入申请页面**
   - 方式1：登录后访问个人中心，点击"申请成为团长"（金色卡片，HOT标签）
   - 方式2：直接访问 `http://localhost:5173/leader/apply`

2. **阅读申请须知**
   - 团长职责
   - 佣金比例（默认10%）
   - 审核时间（1-3个工作日）

3. **填写团长信息**
   - 团长姓名（2-20个字符）
   - 联系电话（11位手机号）

4. **填写团点信息**
   - 团点名称（2-50个字符，如"张团长的团点"）
   - 团点地址（5-200个字符，详细地址）
   - 团点简介（选填，最多500字）

5. **选择服务社区**
   
   **方式1：自动定位匹配**
   - 点击"定位最近社区"按钮
   - 允许浏览器获取位置权限
   - 系统自动匹配最近的社区（使用Haversine算法）
   
   **方式2：按收货地址匹配**
   - 前提：已在"收货地址"页面设置默认地址
   - 点击"按收货地址匹配"按钮
   - 系统根据默认地址自动匹配社区
   
   **方式3：手动选择**
   - 从下拉列表中选择社区
   - 支持输入搜索社区名称
   - 选中后显示社区详细信息
   
   **方式4：申请新社区**
   - 如果现有社区都不合适
   - 点击"没有合适的社区？申请社区支持"
   - 填写新社区信息（名称、地址、经纬度、申请理由）
   - 提交社区申请，等待管理员审核
   - 审核通过后可选择该社区

6. **提交申请**
   - 检查填写信息
   - 点击"提交申请"按钮
   - 确认提交
   - 等待管理员审核

### 查看申请状态

申请提交后，页面会显示申请状态卡片：

**审核中（黄色）**
- 显示"申请审核中"提示
- 可查看申请详情
- 等待管理员审核

**审核通过（绿色）**
- 显示"申请已通过"提示
- 自动获得团长权限
- 可前往个人中心查看团长功能

**审核未通过（红色）**
- 显示"申请未通过"提示
- 查看审核意见
- 可重新申请

### 重新申请

如果申请被拒绝：
1. 查看审核意见，了解拒绝原因
2. 点击"重新申请"按钮
3. 针对问题修改申请信息
4. 重新提交

## 🔧 技术实现

### API接口对接

**团长申请相关**
- `POST /api/leader/apply` - 提交团长申请
- `GET /api/leader/my?userId={userId}` - 查询我的团长信息/申请状态

**社区管理相关**
- `GET /api/community/list` - 查询所有社区
- `GET /api/community/nearest?latitude={lat}&longitude={lng}` - 匹配最近社区（Haversine算法）

**社区申请相关**
- `POST /api/community-application` - 提交社区申请

### 核心功能实现

1. **Haversine距离计算**
   - 根据用户经纬度计算到各社区的球面距离
   - 自动匹配最近的社区
   - 精度误差 < 1%

2. **表单验证**
   ```javascript
   {
     leaderName: 2-20个字符
     leaderPhone: 11位手机号（正则验证）
     communityId: 必选
     storeName: 2-50个字符
     address: 5-200个字符
   }
   ```

3. **状态管理**
   - 0: 待审核
   - 1: 审核通过
   - 2: 审核拒绝

4. **权限控制**
   - 必须登录才能访问（路由守卫）
   - 已经是团长的用户会看到"已通过"状态
   - 个人中心仅向非团长用户显示申请入口

## 📱 页面展示

### 申请表单（PC端）
- 清晰的分区设计（团长信息、团点信息、社区选择）
- 渐变色主题（粉红-橙红）
- 卡片式布局
- 实时表单验证

### 申请表单（移动端）
- 完全响应式设计
- 优化的按钮布局
- 触摸友好的交互

### 申请状态卡片
- 三种状态不同配色（黄色/绿色/红色）
- 大图标 + 文字说明
- 对应操作按钮

### 社区申请对话框
- 弹窗式设计
- 完整的社区信息表单
- 位置定位功能

## 🎨 设计亮点

1. **视觉设计**
   - 统一的渐变色主题
   - 卡片阴影和悬停效果
   - 清晰的层次结构
   - 友好的色彩搭配

2. **交互设计**
   - 一键定位社区
   - 智能地址匹配
   - 实时验证反馈
   - 二次确认提交
   - 清晰的状态提示

3. **体验优化**
   - 加载状态提示
   - 错误信息友好
   - 操作引导清晰
   - 响应速度快

## 📝 注意事项

1. **浏览器权限**
   - 使用"定位最近社区"功能需要允许浏览器获取位置权限
   - 如果拒绝，可使用其他方式选择社区

2. **收货地址**
   - "按收货地址匹配"功能依赖默认收货地址
   - 确保收货地址包含经纬度信息

3. **社区申请**
   - 新社区申请需要等待管理员审核
   - 审核通过后才能在团长申请中选择

4. **重复申请**
   - 一个用户只能提交一份申请
   - 审核拒绝后才能重新申请
   - 已通过的申请不能重复提交

## 🚀 后续扩展

可以考虑添加的功能：

1. **地图选点**
   - 集成高德地图
   - 可视化选择团点位置

2. **图片上传**
   - 团点照片上传
   - 资质证明上传

3. **审核进度查询**
   - 显示审核进度条
   - 邮件/短信通知

4. **历史记录**
   - 查看所有申请记录
   - 申请详情时间线

## 📞 联系支持

如有问题，可以通过以下方式反馈：
- 页面内"意见反馈"功能
- 联系系统管理员

---

**开发完成日期**: 2025-11-06
**版本**: v1.0.0
**开发者**: AI Assistant

